{"ast":null,"code":"import _toConsumableArray from\"G:/projects/photogram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"G:/projects/photogram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"G:/projects/photogram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"G:/projects/photogram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Avatar}from\"@material-ui/core\";import React,{useState,useEffect,useContext}from\"react\";import InputEmoji from\"react-input-emoji\";import{Link}from\"react-router-dom\";import Usercontext from\"../context/user\";import{getAllPostComment,getIndivisualPost}from\"../services/firebase\";import firebase from\"firebase\";import{Comment,Favorite,FavoriteBorder,OpenInNew}from\"@material-ui/icons\";import{FacebookIcon,FacebookShareButton,LinkedinIcon,LinkedinShareButton,WhatsappIcon,WhatsappShareButton}from\"react-share\";import ReactPlayer from\"react-player\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PostPopup(_ref){var postId=_ref.postId;var user=useContext(Usercontext);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),postComment=_useState4[0],setPostComment=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),post=_useState6[0],setPost=_useState6[1];useEffect(function(){function getMyPost(){return _getMyPost.apply(this,arguments);}function _getMyPost(){_getMyPost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var postComments,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getAllPostComment(postId);case 2:postComments=_context.sent;_context.next=5;return getIndivisualPost(postId);case 5:response=_context.sent;_context.next=8;return response.onSnapshot(function(snapshot){setPost(snapshot.data());});case 8:_context.next=10;return postComments.onSnapshot(function(snapshot){setPostComment(snapshot.docs.map(function(doc){return{id:doc.id,data:doc.data()};}));});case 10:case\"end\":return _context.stop();}}},_callee);}));return _getMyPost.apply(this,arguments);}if(postId!==\"\"){getMyPost();}},[postId]);var Liked=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(t){var likeditem,index;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!t){_context2.next=8;break;}likeditem=post.liked;index=likeditem.indexOf(user.user.uid);if(index>-1){likeditem.splice(index,1);}_context2.next=6;return firebase.firestore().collection(\"photos\").doc(postId).update({liked:likeditem});case 6:_context2.next=10;break;case 8:_context2.next=10;return firebase.firestore().collection(\"photos\").doc(postId).update({liked:[].concat(_toConsumableArray(post.liked),[user.user.uid])});case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function Liked(_x){return _ref2.apply(this,arguments);};}();var PostComment=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var comments;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:// e.preventDefault();\ncomments=[].concat(_toConsumableArray(postComment),[{comment:comment,commentUser:user.user.username,timestamp:firebase.firestore.FieldValue.serverTimestamp(),commentUserUid:user.user.uid}]);_context3.next=3;return firebase.firestore().collection(\"photos\").doc(postId).collection(\"comments\").add({comment:comment,commentUser:user.user.displayName,timestamp:firebase.firestore.FieldValue.serverTimestamp(),commentUserUid:user.user.uid});case 3:// setThisImageComment(comments);\nsetComment(\"\");case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function PostComment(_x2){return _ref3.apply(this,arguments);};}();// if (post && user) {\n//   if (post.liked.includes(user.user.uid)) {\n//     setLike(true);\n//   } else {\n//     setLike(false);\n//   }\n// }\nreturn post?/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"60% 40%\"},children:[/*#__PURE__*/_jsx(\"div\",{children:post.type===\"video\"?/*#__PURE__*/_jsx(ReactPlayer,{url:post.fileUrl,controls:\"true\",width:\"100%\",height:\"89vh\",style:{width:\"100%\",height:\"89vh\",objectFit:\"contain\"}}):/*#__PURE__*/_jsx(\"img\",{src:post.fileUrl,alt:\"post Image\",style:{width:\"100%\",height:\"89vh\",border:\"1px solid black\",// position: \"relative\",\nobjectFit:\"contain\"}})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",margin:\"10px\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",alignItems:\"center\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{marginLeft:\"10px\"},children:[/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(post.user_uid),style:{textDecoration:\"none\"},children:/*#__PURE__*/_jsx(\"h5\",{children:post.username})}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:\"10px\",color:\"gray\"},children:post.timestamp.toDate().toDateString()})]})}),/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(post.user_uid),style:{textDecoration:\"none\"},children:\"Profile\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"p\",{style:{borderBottom:\"1px solid black\",fontSize:\"14px\",paddingLeft:\"10px\",paddingBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"b\",{children:\"caption: \"}),post.caption,/*#__PURE__*/_jsx(\"span\",{style:{color:\"gray\",fontSize:\"13px\",marginLeft:\"6px\"},children:post.caption===\"Update my Profile Pic at\"?post.timestamp.toDate().toDateString():null})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{style:{margin:\"10px 0px 0px 10px\",overflow:\"scroll\",overflowX:\"hidden\",height:\"55vh\"},children:postComment.map(function(_ref4){var data=_ref4.data,id=_ref4.id;return/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",// alignItems: \"center\",\nmargin:\"5px 7px 9px 5px \"},children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{color:\"#610909\",fontSize:\"15px\",fontWeight:\"bold\",marginRight:\"5px\"},children:/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(data.commentUserUid),style:{textDecoration:\"none\"},children:[data?data.commentUser:null,\" :\"]})}),/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:\"15px\",color:\"#4a4747\"},children:[data?data.comment:null,\" \"]}),/*#__PURE__*/_jsx(\"span\",{style:{color:\"gray\",fontSize:\"10px\"},children:data?data.timestamp?data.timestamp.toDate().toDateString():null:null})]})},id);})})}),/*#__PURE__*/_jsxs(\"div\",{style:{position:\"fixed\",bottom:\"0px\",width:\"32vw\",backgroundColor:\"#c7c7c7\",borderTop:\"2px solid gray\"},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\" \",user?/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",margin:\"10px 10px 0 10px\"},children:[/*#__PURE__*/_jsxs(\"div\",{children:[post.liked.includes(user.user.uid)?/*#__PURE__*/_jsx(Favorite,{style:{marginLeft:\"10px\",marginRight:\"10px\",color:\"red\",cursor:\"pointer\"},onClick:function onClick(){return Liked(true);}}):/*#__PURE__*/_jsx(FavoriteBorder,{style:{marginLeft:\"10px\",marginRight:\"10px\",cursor:\"pointer\"},onClick:function onClick(){return Liked(false);}}),/*#__PURE__*/_jsx(Comment,{}),/*#__PURE__*/_jsx(Link,{style:{marginLeft:\"10px\"},to:\"/image/\".concat(postId),children:/*#__PURE__*/_jsx(OpenInNew,{})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FacebookShareButton,{url:\"\".concat(window.location.href,\"image/\").concat(postId)// quote={props.joke.setup + props.joke.punchline}\n,hashtag:\"#StupidProgrammer\",children:/*#__PURE__*/_jsx(FacebookIcon,{size:25,round:true})}),/*#__PURE__*/_jsx(WhatsappShareButton,{url:\"\".concat(window.location.href,\"image/\").concat(postId)// quote={props.joke.setup + props.joke.punchline}\n,hashtag:\"#StupidProgrammer\",children:/*#__PURE__*/_jsx(WhatsappIcon,{size:25,round:true,style:{marginLeft:\"5px\",marginRight:\"5px\"}})}),/*#__PURE__*/_jsx(LinkedinShareButton,{url:\"\".concat(window.location.href,\"image/\").concat(postId)// quote={props.joke.setup + props.joke.punchline}\n,hashtag:\"#StupidProgrammer\",children:/*#__PURE__*/_jsx(LinkedinIcon,{size:25,round:true})})]})]}):null,/*#__PURE__*/_jsxs(\"p\",{style:{marginLeft:\"10px\",color:\"gray\",marginTop:\"-5px\",fontSize:\"10px\"},children:[post.liked.length,\" likes \",postComment.length,\" comments\"]})]}),/*#__PURE__*/_jsx(InputEmoji,{maxLength:200,style:{width:\"100vw\",backgroundColor:\"gray\"},value:comment,onChange:setComment,cleanOnEnter:true,onEnter:PostComment,placeholder:\"Type a message\"})]})]})]}):null;}export default PostPopup;","map":{"version":3,"sources":["G:/projects/photogram/src/components/PostPopup.js"],"names":["Avatar","React","useState","useEffect","useContext","InputEmoji","Link","Usercontext","getAllPostComment","getIndivisualPost","firebase","Comment","Favorite","FavoriteBorder","OpenInNew","FacebookIcon","FacebookShareButton","LinkedinIcon","LinkedinShareButton","WhatsappIcon","WhatsappShareButton","ReactPlayer","PostPopup","postId","user","comment","setComment","postComment","setPostComment","post","setPost","getMyPost","postComments","response","onSnapshot","snapshot","data","docs","map","doc","id","Liked","t","likeditem","liked","index","indexOf","uid","splice","firestore","collection","update","PostComment","e","comments","commentUser","username","timestamp","FieldValue","serverTimestamp","commentUserUid","add","displayName","display","gridTemplateColumns","type","fileUrl","width","height","objectFit","border","alignItems","justifyContent","margin","marginLeft","user_uid","textDecoration","fontSize","color","toDate","toDateString","borderBottom","paddingLeft","paddingBottom","caption","overflow","overflowX","fontWeight","marginRight","position","bottom","backgroundColor","borderTop","includes","cursor","window","location","href","marginTop","length"],"mappings":"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","sourcesContent":["import { Avatar } from \"@material-ui/core\";\r\nimport React, { useState, useEffect, useContext } from \"react\";\r\nimport InputEmoji from \"react-input-emoji\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Usercontext from \"../context/user\";\r\nimport { getAllPostComment, getIndivisualPost } from \"../services/firebase\";\r\nimport firebase from \"firebase\";\r\nimport {\r\n  Comment,\r\n  Favorite,\r\n  FavoriteBorder,\r\n  OpenInNew,\r\n} from \"@material-ui/icons\";\r\nimport {\r\n  FacebookIcon,\r\n  FacebookShareButton,\r\n  LinkedinIcon,\r\n  LinkedinShareButton,\r\n  WhatsappIcon,\r\n  WhatsappShareButton,\r\n} from \"react-share\";\r\nimport ReactPlayer from \"react-player\";\r\n\r\nfunction PostPopup({ postId }) {\r\n  const user = useContext(Usercontext);\r\n\r\n  const [comment, setComment] = useState(\"\");\r\n  const [postComment, setPostComment] = useState([]);\r\n  const [post, setPost] = useState(null);\r\n\r\n  useEffect(() => {\r\n    async function getMyPost() {\r\n      const postComments = await getAllPostComment(postId);\r\n      const response = await getIndivisualPost(postId);\r\n\r\n      await response.onSnapshot((snapshot) => {\r\n        setPost(snapshot.data());\r\n      });\r\n\r\n      await postComments.onSnapshot((snapshot) => {\r\n        setPostComment(\r\n          snapshot.docs.map((doc) => ({\r\n            id: doc.id,\r\n            data: doc.data(),\r\n          }))\r\n        );\r\n      });\r\n    }\r\n    if (postId !== \"\") {\r\n      getMyPost();\r\n    }\r\n  }, [postId]);\r\n\r\n  const Liked = async (t) => {\r\n    if (t) {\r\n      const likeditem = post.liked;\r\n      var index = likeditem.indexOf(user.user.uid);\r\n      if (index > -1) {\r\n        likeditem.splice(index, 1);\r\n      }\r\n      await firebase.firestore().collection(\"photos\").doc(postId).update({\r\n        liked: likeditem,\r\n      });\r\n    } else {\r\n      await firebase\r\n        .firestore()\r\n        .collection(\"photos\")\r\n        .doc(postId)\r\n        .update({\r\n          liked: [...post.liked, user.user.uid],\r\n        });\r\n    }\r\n  };\r\n\r\n  const PostComment = async (e) => {\r\n    // e.preventDefault();\r\n    const comments = [\r\n      ...postComment,\r\n      {\r\n        comment: comment,\r\n        commentUser: user.user.username,\r\n        timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n        commentUserUid: user.user.uid,\r\n      },\r\n    ];\r\n\r\n    await firebase\r\n      .firestore()\r\n      .collection(\"photos\")\r\n      .doc(postId)\r\n      .collection(\"comments\")\r\n      .add({\r\n        comment: comment,\r\n        commentUser: user.user.displayName,\r\n        timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n        commentUserUid: user.user.uid,\r\n      });\r\n\r\n    // setThisImageComment(comments);\r\n\r\n    setComment(\"\");\r\n  };\r\n\r\n  // if (post && user) {\r\n  //   if (post.liked.includes(user.user.uid)) {\r\n  //     setLike(true);\r\n  //   } else {\r\n  //     setLike(false);\r\n  //   }\r\n  // }\r\n\r\n  return post ? (\r\n    <div style={{ display: \"grid\", gridTemplateColumns: \"60% 40%\" }}>\r\n      <div\r\n      // style={{ borderRight: \"1px solid gray\", backgroundColor: \"#343835\" }}\r\n      >\r\n        {post.type === \"video\" ? (\r\n          <ReactPlayer\r\n            url={post.fileUrl}\r\n            controls=\"true\"\r\n            width = '100%'\r\n            height = \"89vh\"\r\n            style={{\r\n              width: \"100%\",\r\n              height: \"89vh\",\r\n              objectFit: \"contain\",\r\n            }}\r\n          />\r\n        ) : (\r\n          <img\r\n            src={post.fileUrl}\r\n            alt=\"post Image\"\r\n            style={{\r\n              width: \"100%\",\r\n              height: \"89vh\",\r\n              border: \"1px solid black\",\r\n\r\n              // position: \"relative\",\r\n\r\n              objectFit: \"contain\",\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n      <div>\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"space-between\",\r\n            margin: \"10px\",\r\n          }}\r\n        >\r\n          <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n            {/* <Avatar /> */}\r\n            <div style={{ marginLeft: \"10px\" }}>\r\n              <Link\r\n                to={`/profile/${post.user_uid}`}\r\n                style={{ textDecoration: \"none\" }}\r\n              >\r\n                <h5>{post.username}</h5>\r\n              </Link>\r\n\r\n              <p style={{ fontSize: \"10px\", color: \"gray\" }}>\r\n                {post.timestamp.toDate().toDateString()}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <Link\r\n            to={`/profile/${post.user_uid}`}\r\n            style={{ textDecoration: \"none\" }}\r\n          >\r\n            Profile\r\n          </Link>\r\n        </div>\r\n        <div>\r\n          <p\r\n            style={{\r\n              borderBottom: \"1px solid black\",\r\n              fontSize: \"14px\",\r\n              paddingLeft: \"10px\",\r\n              paddingBottom: \"10px\",\r\n            }}\r\n          >\r\n            <b>caption: </b>\r\n            {post.caption}\r\n            <span\r\n              style={{ color: \"gray\", fontSize: \"13px\", marginLeft: \"6px\" }}\r\n            >\r\n              {post.caption === \"Update my Profile Pic at\"\r\n                ? post.timestamp.toDate().toDateString()\r\n                : null}\r\n            </span>\r\n          </p>\r\n        </div>\r\n        <div>\r\n          <div\r\n            style={{\r\n              margin: \"10px 0px 0px 10px\",\r\n              overflow: \"scroll\",\r\n              overflowX: \"hidden\",\r\n              height: \"55vh\",\r\n            }}\r\n          >\r\n            {postComment.map(({ data, id }) => (\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  // alignItems: \"center\",\r\n                  margin: \"5px 7px 9px 5px \",\r\n                }}\r\n                key={id}\r\n              >\r\n                <p>\r\n                  <span\r\n                    style={{\r\n                      color: \"#610909\",\r\n                      fontSize: \"15px\",\r\n                      fontWeight: \"bold\",\r\n                      marginRight: \"5px\",\r\n                    }}\r\n                  >\r\n                    <Link\r\n                      to={`/profile/${data.commentUserUid}`}\r\n                      style={{ textDecoration: \"none\" }}\r\n                    >\r\n                      {data ? data.commentUser : null} :\r\n                    </Link>\r\n                  </span>\r\n                  <span style={{ fontSize: \"15px\", color: \"#4a4747\" }}>\r\n                    {data ? data.comment : null}{\" \"}\r\n                  </span>\r\n                  <span style={{ color: \"gray\", fontSize: \"10px\" }}>\r\n                    {data\r\n                      ? data.timestamp\r\n                        ? data.timestamp.toDate().toDateString()\r\n                        : null\r\n                      : null}\r\n                  </span>\r\n                </p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            bottom: \"0px\",\r\n            width: \"32vw\",\r\n            backgroundColor: \"#c7c7c7\",\r\n            borderTop: \"2px solid gray\",\r\n          }}\r\n        >\r\n          <div>\r\n            {\" \"}\r\n            {user ? (\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  alignItems: \"center\",\r\n                  justifyContent: \"space-between\",\r\n                  margin: \"10px 10px 0 10px\",\r\n                }}\r\n              >\r\n                <div>\r\n                  {post.liked.includes(user.user.uid) ? (\r\n                    <Favorite\r\n                      style={{\r\n                        marginLeft: \"10px\",\r\n                        marginRight: \"10px\",\r\n                        color: \"red\",\r\n                        cursor: \"pointer\",\r\n                      }}\r\n                      onClick={() => Liked(true)}\r\n                    />\r\n                  ) : (\r\n                    <FavoriteBorder\r\n                      style={{\r\n                        marginLeft: \"10px\",\r\n                        marginRight: \"10px\",\r\n                        cursor: \"pointer\",\r\n                      }}\r\n                      onClick={() => Liked(false)}\r\n                    />\r\n                  )}\r\n\r\n                  <Comment />\r\n                  <Link style={{ marginLeft: \"10px\" }} to={`/image/${postId}`}>\r\n                    <OpenInNew />\r\n                  </Link>\r\n                </div>\r\n                <div>\r\n                  <FacebookShareButton\r\n                    url={`${window.location.href}image/${postId}`}\r\n                    // quote={props.joke.setup + props.joke.punchline}\r\n                    hashtag=\"#StupidProgrammer\"\r\n                  >\r\n                    <FacebookIcon size={25} round={true} />\r\n                  </FacebookShareButton>\r\n                  <WhatsappShareButton\r\n                    url={`${window.location.href}image/${postId}`}\r\n                    // quote={props.joke.setup + props.joke.punchline}\r\n                    hashtag=\"#StupidProgrammer\"\r\n                  >\r\n                    <WhatsappIcon\r\n                      size={25}\r\n                      round={true}\r\n                      style={{ marginLeft: \"5px\", marginRight: \"5px\" }}\r\n                    />\r\n                  </WhatsappShareButton>\r\n                  <LinkedinShareButton\r\n                    url={`${window.location.href}image/${postId}`}\r\n                    // quote={props.joke.setup + props.joke.punchline}\r\n                    hashtag=\"#StupidProgrammer\"\r\n                  >\r\n                    <LinkedinIcon size={25} round={true} />\r\n                  </LinkedinShareButton>\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n            <p\r\n              style={{\r\n                marginLeft: \"10px\",\r\n                color: \"gray\",\r\n                marginTop: \"-5px\",\r\n                fontSize: \"10px\",\r\n              }}\r\n            >\r\n              {post.liked.length} likes {postComment.length} comments\r\n            </p>\r\n          </div>\r\n          <InputEmoji\r\n            maxLength={200}\r\n            style={{ width: \"100vw\", backgroundColor: \"gray\" }}\r\n            value={comment}\r\n            onChange={setComment}\r\n            cleanOnEnter\r\n            onEnter={PostComment}\r\n            placeholder=\"Type a message\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n}\r\n\r\nexport default PostPopup;\r\n"]},"metadata":{},"sourceType":"module"}