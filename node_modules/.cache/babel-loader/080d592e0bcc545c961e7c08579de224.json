{"ast":null,"code":"import _regeneratorRuntime from\"G:/projects/photogram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"G:/projects/photogram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"G:/projects/photogram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from\"react\";import{Link,useHistory}from\"react-router-dom\";import*as ROUTES from\"../constants/routes\";import SignupImage from\"../images/unnamed.png\";import{doesUsernameExist}from\"../services/firebase\";import firebase from\"firebase\";import{db,auth}from\"../firebase\";import\"./signup.css\";import Usercontext from\"../context/user\";import{Button,Input}from\"@material-ui/core\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function SignUp(){var history=useHistory();var user=useContext(Usercontext);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),userName=_useState4[0],setUserName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),email=_useState6[0],setEmail=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),confirmPassword=_useState10[0],setComfirmPassword=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),error=_useState12[0],setError=_useState12[1];var isInvalid=name.trim()===\"\"||userName.trim()===\"\"||email.trim()===\"\"||password.trim()===\"\"||confirmPassword.trim()===\"\";var signUp=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var usernameExists,createdUserResult;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.next=3;return doesUsernameExist(userName);case 3:usernameExists=_context.sent;if(!(password===confirmPassword)){_context.next=30;break;}if(usernameExists.length){_context.next=27;break;}_context.prev=6;_context.next=9;return firebase.auth().createUserWithEmailAndPassword(email,password);case 9:createdUserResult=_context.sent;_context.next=12;return createdUserResult.user.updateProfile({displayName:userName});case 12:_context.next=14;return firebase.firestore().collection(\"users\").add({userId:createdUserResult.user.uid,profile_photo:\"\",chat_friends:[],chatUrl:{},username:userName.toLowerCase(),fullName:name.toLowerCase(),emailAddress:email.toLowerCase(),following:[createdUserResult.user.uid],follower:[createdUserResult.user.uid],dateCreated:Date.now(),profilePicUpdatedAt:\"\",status:\"\"});case 14:history.push(ROUTES.HOME);_context.next=25;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](6);setName(\"\");setUserName(\"\");setEmail(\"\");setPassword(\"\");setComfirmPassword(\"\");setError(_context.t0.message);case 25:_context.next=28;break;case 27:setError(\"This username is already taken\");case 28:_context.next=31;break;case 30:setError(\"password and confirm password did not match\");case 31:case\"end\":return _context.stop();}}},_callee,null,[[6,17]]);}));return function signUp(_x){return _ref.apply(this,arguments);};}();return user.user?/*#__PURE__*/_jsxs(\"p\",{children:[\" \",\"Sorry permission denied, You have to SignOout first for entering this page\",\" \"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"signup\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"signup__left\",children:/*#__PURE__*/_jsx(\"img\",{src:SignupImage,alt:\"signup image\",className:\"signup_image\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"signup__right\",children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\"},children:\" SignUp\"}),error&&/*#__PURE__*/_jsxs(\"p\",{style:{color:\"red\"},children:[\" \",error]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:signUp,className:\"signup__form\",children:[/*#__PURE__*/_jsx(Input,{type:\"text\",value:userName,onChange:function onChange(e){return setUserName(e.target.value);},placeholder:\"Username :\",className:\"signup__input\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",value:name,onChange:function onChange(e){return setName(e.target.value);},placeholder:\"Name :\",className:\"signup__input\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",value:email,onChange:function onChange(e){return setEmail(e.target.value);},placeholder:\"Email\",className:\"signup__input\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);},placeholder:\"Password :\",className:\"signup__input\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",value:confirmPassword,onChange:function onChange(e){return setComfirmPassword(e.target.value);},placeholder:\"Confirm Password :\",className:\"signup__input\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:isInvalid,className:\"signup__input\",variant:\"contained\",children:\"SignUp\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\" \",\"if you have a account \",/*#__PURE__*/_jsx(Link,{to:ROUTES.LOGIN,children:\"Login\"})]})]})]});}export default SignUp;","map":{"version":3,"sources":["G:/projects/photogram/src/pages/SignUp.js"],"names":["React","useState","useContext","Link","useHistory","ROUTES","SignupImage","doesUsernameExist","firebase","db","auth","Usercontext","Button","Input","SignUp","history","user","name","setName","userName","setUserName","email","setEmail","password","setPassword","confirmPassword","setComfirmPassword","error","setError","isInvalid","trim","signUp","e","preventDefault","usernameExists","length","createUserWithEmailAndPassword","createdUserResult","updateProfile","displayName","firestore","collection","add","userId","uid","profile_photo","chat_friends","chatUrl","username","toLowerCase","fullName","emailAddress","following","follower","dateCreated","Date","now","profilePicUpdatedAt","status","push","HOME","message","textAlign","color","target","value","LOGIN"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport * as ROUTES from \"../constants/routes\";\r\nimport SignupImage from \"../images/unnamed.png\";\r\nimport { doesUsernameExist } from \"../services/firebase\";\r\nimport firebase from \"firebase\";\r\nimport { db, auth } from \"../firebase\";\r\n\r\nimport \"./signup.css\";\r\nimport Usercontext from \"../context/user\";\r\nimport { Button, Input } from \"@material-ui/core\";\r\n\r\nfunction SignUp() {\r\n  const history = useHistory();\r\n  const user = useContext(Usercontext);\r\n  const [name, setName] = useState(\"\");\r\n  const [userName, setUserName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [confirmPassword, setComfirmPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const isInvalid =\r\n    name.trim() === \"\" ||\r\n    userName.trim() === \"\" ||\r\n    email.trim() === \"\" ||\r\n    password.trim() === \"\" ||\r\n    confirmPassword.trim() === \"\";\r\n\r\n  const signUp = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const usernameExists = await doesUsernameExist(userName);\r\n    // console.log(usernameExists);\r\n\r\n    if (password === confirmPassword) {\r\n      if (!usernameExists.length) {\r\n        // console.log(\"hello\");\r\n        try {\r\n          const createdUserResult = await firebase\r\n            .auth()\r\n            .createUserWithEmailAndPassword(email, password);\r\n\r\n          await createdUserResult.user.updateProfile({\r\n            displayName: userName,\r\n          });\r\n\r\n          await firebase\r\n            .firestore()\r\n            .collection(\"users\")\r\n            .add({\r\n              userId: createdUserResult.user.uid,\r\n              profile_photo: \"\",\r\n              chat_friends: [],\r\n              chatUrl: {},\r\n              username: userName.toLowerCase(),\r\n              fullName: name.toLowerCase(),\r\n              emailAddress: email.toLowerCase(),\r\n              following: [createdUserResult.user.uid],\r\n              follower: [createdUserResult.user.uid],\r\n              dateCreated: Date.now(),\r\n              profilePicUpdatedAt: \"\",\r\n              status: \"\",\r\n            });\r\n          history.push(ROUTES.HOME);\r\n        } catch (error) {\r\n          setName(\"\");\r\n          setUserName(\"\");\r\n          setEmail(\"\");\r\n          setPassword(\"\");\r\n          setComfirmPassword(\"\");\r\n          setError(error.message);\r\n        }\r\n      } else {\r\n        setError(\"This username is already taken\");\r\n      }\r\n    } else {\r\n      setError(\"password and confirm password did not match\");\r\n    }\r\n  };\r\n\r\n  return user.user ? (\r\n    <p>\r\n      {\" \"}\r\n      Sorry permission denied, You have to SignOout first for entering this page{\" \"}\r\n    </p>\r\n  ) : (\r\n    <div className=\"signup\">\r\n      <div className=\"signup__left\">\r\n        <img src={SignupImage} alt=\"signup image\" className=\"signup_image\" />\r\n      </div>\r\n      <div className=\"signup__right\">\r\n        <h2 style={{ textAlign: \"center\" }}> SignUp</h2>\r\n        {error && <p style={{ color: \"red\" }}> {error}</p>}\r\n        <form onSubmit={signUp} className=\"signup__form\">\r\n          <Input\r\n            type=\"text\"\r\n            value={userName}\r\n            onChange={(e) => setUserName(e.target.value)}\r\n            placeholder=\"Username :\"\r\n            className=\"signup__input\"\r\n          />\r\n\r\n          <Input\r\n            type=\"text\"\r\n            value={name}\r\n            onChange={(e) => setName(e.target.value)}\r\n            placeholder=\"Name :\"\r\n            className=\"signup__input\"\r\n          />\r\n\r\n          <Input\r\n            type=\"text\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n            placeholder=\"Email\"\r\n            className=\"signup__input\"\r\n          />\r\n\r\n          <Input\r\n            type=\"password\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            placeholder=\"Password :\"\r\n            className=\"signup__input\"\r\n          />\r\n\r\n          <Input\r\n            type=\"password\"\r\n            value={confirmPassword}\r\n            onChange={(e) => setComfirmPassword(e.target.value)}\r\n            placeholder=\"Confirm Password :\"\r\n            className=\"signup__input\"\r\n          />\r\n          <Button type=\"submit\" disabled={isInvalid} className=\"signup__input\" variant=\"contained\">\r\n            SignUp\r\n          </Button>\r\n        </form>\r\n        <p>\r\n          {\" \"}\r\n          if you have a account <Link to={ROUTES.LOGIN}>Login</Link>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SignUp;\r\n"]},"metadata":{},"sourceType":"module"}